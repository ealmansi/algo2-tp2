\begin{tad}{\tadNombre{SistemaLaboralExtendido}}

\tadExtiende{SistemaLaboral}

\tadGeneradores
\tadOperacion{nuevo}{}{SL}{}
\tadOperacion{agregarGremio}{SL/sl, conj(empresa)/es, nat/\#as}{SL}{}
\tadOperacion{aliar}{SL/sl, nat/idGr1, nat/idGr2}{SL}{$idGr1 \ne idGr2 \ly ((\exists g1, g2: gremio)\, g_1 \in gremios(sl) \land g_2 \in gremios(sl) \land $ \\ $idGremio(g_1) = idGr1 \land idGremio(g_2) = idGr2 \land idGr1 \not \in aliados(sl, idGr2))$}

\tadObservadores
\tadOperacion{gremios}{SL/sl}{conj(Gremio)}{}
\tadOperacion{aliados}{SL/sl,nat/idGr}{conj(nat)}{}

\vspace{3 mm}

\tadOtrasOperaciones

\tadOperacion{idUltimoGremioAgregado}{SL/sl}{nat}{$\lnot \emptyset?(gremios(sl))$}
\tadOperacion{obtenerGremiosSegunGrupo}{conj(Gremio)/gs, nat/idGrupo}{conj(Gremio)}{}
\tadOperacion{actualizarIdGrupos}{conj(Gremio)/gs, nat/idGrupoMin, nat/idGrupoMax}{conj(Gremio)}{}

\vspace{3 mm}

\tadAxiomas[]

\vspace{3 mm}

\tadAxioma{gremios(nuevo)}{$\emptyset$}
\tadAxioma{gremios(agregarGremio(sl, es, \#as))}{asignarIdGrupo(asignarIdGremio(nuevoGremio(es,\#as), \#(gremios(sl))), \#(gremios(sl))) $\cup$ gremios(sl)}
\tadAxioma{gremios(aliar(sl, idGr1, idGr2))}{actualizarIdGrupos(gremios(sl),min(idGr1,idGr2),max(idGr1,idGr2))}

\vspace{3 mm}

\tadAxioma{aliados(nuevo)}{$\emptyset$}
\tadAxioma{aliados(agregarGremio(sl, es, \#as), idGr)}{aliados(sl, idGr)}
\tadAxioma{aliados(aliar(sl, idGr1, idGr2), idGr)}
{
	\textbf{if} idGr = idGr1 $\lor$ idGr = idGr2 \textbf{then} \\
		\hspace*{20pt}\textbf{if} idGr = idGr1 \textbf{then} \\
			\hspace*{40pt}\hspace*{20pt}aliados(sl, idGr1) $\cup$ aliados(sl, idGr2) $\cup$ \{idGr2\}\\
		\hspace*{20pt}\textbf{else} \\
			\hspace*{40pt}\hspace*{20pt}aliados(sl, idGr1) $\cup$ aliados(sl, idGr2) $\cup$ \{idGr1\}\\
		\hspace*{20pt}\textbf{fi}\\
	\textbf{else} \\
		\hspace*{20pt}aliados(sl,idGr)\\
	\textbf{fi} \\
}

\vspace{3 mm}

\tadAxioma{idUltimoGremioAgregado(agregarGremio(sl, es, \#as))}{\#(gremios(sl)) - 1}

\vspace{3 mm}

\tadAxioma{obtenerGremiosSegunGrupo(gs,idGrupo)}
{
	\textbf{if} $\emptyset$?(gs) \textbf{then} \\
		\hspace*{20pt}$\emptyset$	\\
	\textbf{else} \\
		\hspace*{20pt}\textbf{if} idGrupo(dameUno(gs)) = idGrupo \textbf{then} \\
			\hspace*{40pt}Ag(dameUno(gs), $\emptyset$) \\
		\hspace*{20pt}\textbf{else} \\
			\hspace*{40pt}$\emptyset$\\
		\hspace*{20pt}\textbf{fi} $\cup$ obtenerGremiosSegunGrupo(sinUno(gs), idGrupo)\\
	\textbf{fi} \\
}

\vspace{3 mm}

\tadAxioma{actualizarIdGrupos(gs, idMin, idMax)}
{
	\textbf{if} idGrupo(dameUno(gs)) = idMax \textbf{then} \\
		\hspace*{20pt}\{asignarIdGrupo(dameUno(gs), idMin)\}	\\
	\textbf{else} \\
		\hspace*{20pt}\textbf{if} idGrupo(dameUno(gs)) $>$ idMax \textbf{then} \\
			\hspace*{40pt} \{asignarIdGrupo(dameUno(gs), idGrupo(dameUno(gs)) - 1)\}	\\
		\hspace*{20pt}\textbf{else} \\
			\hspace*{40pt} \{dameUno(gs)\} \\
		\hspace*{20pt}\textbf{fi} $\cup$ actualizarIdGrupos(sinUno(gs), idMin, idMax)\\
	\textbf{fi} \\
}

\end{tad}

\newpage